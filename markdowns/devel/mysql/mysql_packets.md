# MySQL 包（Packets)

如果MySQL客户端或服务器向发送包，他需要：

- 将数据以大小为$2^{24}$ 作分割
- 每一块（chunk）前插入一个包头

## 协议之包 (Protocol::Packet)

客户端和服务器之间的传输的包大小最大不超过16MB。

playload如下：

|     类型      |   名称   |                     描述                      |
| :-----------: | :------: | :-------------------------------------------: |
|   `int<3>`    | 负载长度 | 负载的长度 。 包的字节数去掉包头开始的4字节。 |
|   `int<1>`    |  序列号  |                    序列号                     |
| `string<var>` |   负载   |                   包的负载                    |

例如，

`01 00 00 00 01`,

- 长度为1
- 序列号为0
- 负载为1

### 发送内容超过16Mb时

如果负载长度超过$2^{24} - 1$(含)，需要分割为多个小于等于16Mb的包，

### 序列号 (Sequence ID)

在每个包中，序列号是递增的，可能会循环。当一个新的命令开始，它从0开始，重置为0.

### 文档中的包描述

在本文档中，我们统统以下方式描述所有的包。

- 首先定义它的负载
- 然后提供一个被发送的包的例子，包括包头：

```xml
<packetname>
  <description>
      direction: client -> server
      response: <response>
      payload:
      	<type>    <description>
```



